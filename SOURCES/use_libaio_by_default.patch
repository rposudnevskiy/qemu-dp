Use libaio by default

From: Stefano Panella <Stefano.Panella@citrix.com>

diff --git a/block/file-posix.c b/block/file-posix.c
index cb3bfce..a029c1d 100644
--- a/block/file-posix.c
+++ b/block/file-posix.c
@@ -374,7 +374,9 @@ static void raw_parse_flags(int bdrv_flags, int *open_flags)
     /* Use O_DSYNC for write-through caching, no flags for write-back caching,
      * and O_DIRECT for no caching. */
     if ((bdrv_flags & BDRV_O_NOCACHE)) {
-        *open_flags |= O_DIRECT;
+        if ((bdrv_flags & BDRV_O_RDWR) != 0) {
+            *open_flags |= O_DIRECT;
+        }
     }
 }
 
@@ -438,6 +440,7 @@ static int raw_open_common(BlockDriverState *bs, QDict *options,
     aio_default = (bdrv_flags & BDRV_O_NATIVE_AIO)
                   ? BLOCKDEV_AIO_OPTIONS_NATIVE
                   : BLOCKDEV_AIO_OPTIONS_THREADS;
+    aio_default = BLOCKDEV_AIO_OPTIONS_NATIVE;
     aio = qapi_enum_parse(BlockdevAioOptions_lookup, qemu_opt_get(opts, "aio"),
                           BLOCKDEV_AIO_OPTIONS__MAX, aio_default, &local_err);
     if (local_err) {
@@ -507,12 +510,12 @@ static int raw_open_common(BlockDriverState *bs, QDict *options,
 
 #ifdef CONFIG_LINUX_AIO
      /* Currently Linux does AIO only for files opened with O_DIRECT */
-    if (s->use_linux_aio && !(s->open_flags & O_DIRECT)) {
-        error_setg(errp, "aio=native was specified, but it requires "
-                         "cache.direct=on, which was not specified.");
-        ret = -EINVAL;
-        goto fail;
-    }
+    /* if (s->use_linux_aio && !(s->open_flags & O_DIRECT)) { */
+    /*     error_setg(errp, "aio=native was specified, but it requires " */
+    /*                      "cache.direct=on, which was not specified."); */
+    /*     ret = -EINVAL; */
+    /*     goto fail; */
+    /* } */
 #else
     if (s->use_linux_aio) {
         error_setg(errp, "aio=native was specified, but is not supported "
